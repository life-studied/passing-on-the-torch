# 1.1什么是Internet

## 1.1.1从具体构成角度

### 节点

- 主机接点（主机及其上运行的应用程序）

- 数据交换节点（一层：中继器  二层：交换机  三层：路由器）



数以亿计的、互联的计算设备:

- 主机 = 端系统

- 运行网络应用程序



分组交换设备：转发分组

- 路由器和交换机

### 边：通信链路

- 接入网链路：主机连接到互联网的链路

- 主干链路：路由器间的链路



例如：光纤、同轴电缆、无线电、卫星
传输速率 = 带宽（bps）

### 协议

协议控制发送、接收消息

如TCP、IP、HTTP、FTP、PPP

Internet 中所有的通信行为都受协议制约

协议定义了在两个或多个通信实体之间交换的报文格式和次序，以及在报文传输和/或接收或其他事件方面所采取的动作。

人类协议和计算机网络协议示例：

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image.png)

### Internet：“网络的网络”

- 松散的层次结构，互连的ISP

- 公共Internet vs. 专用intranet

### Internet标准

- RFC: Request for comments

- IETF: Internet Engineering Task Force

## 1.1.2从服务构成角度

### 使用通信设施进行通信的分布式应用

应用层以下的所有的协议实体

### 通信基础设施为apps提供编程接口（通信服务）

将发送和接收数据的apps与互联网连接起来

为app应用提供服务选择，类似于邮政服务：

- 无连接不可靠服务

- 面向连接的可靠服务

# 1.2网络边缘

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 1.png)

### 端系统（主机）：

- 运行应用程序

- 如Web、email

- 在 “网络的边缘”

### 客户/服务器模式

- 客户端向服务器请求、接收服务

- 如Web浏览器/服务器

### 对等（peer-peer ）模式

- 很少（甚至没有）专门的服务器

- 如 Gnutella、KaZaA、Emule

## 1.2.1采用网络设施的面向连接服务

目标：在端系统之间传输数据

### 握手：在数据传输之前做好准备

- 人类协议中：你好、你好

- 两个通信主机之间为连接建立状态

### TCP – 传输控制协议（Transmission Control Protocol ）

Internet上面向连接的服务

### TCP 服务

- 可靠地、按顺序地传送数据（确认和重传）

- 流量控制（发送方不会淹没接收方）

- 拥塞控制（当网络拥塞时，发送方降低发送速率）

### 使用TCP的应用：

HTTP (Web), FTP (文件传送), Telnet (远程登录),SMTP (email)

## 1.2.2采用基础设施的无连接服务

目标：在端系统之间传输数据

### UDP – 用户数据报协议(User DatagramProtocol)

- 无连接

- 不可靠数据传输

- 无流量控制

- 无拥塞控制

### 使用 UDP的应用：

流媒体、远程会议、 DNS、Internet电话

# 1.3网络核心

网络核心：路由器的网状网络

基本问题：数据怎样通过网络进行传输？

## 1.3.1电路交换

电路交换：为每个呼叫预留一条专有电路：如电话网

### 端到端的资源被分配给从源端到目标端的呼叫 “call”

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 2.png)

图中，每段链路有4条线路：该呼叫采用了上面链路的第2个线路，右边链路的第1个线路（piece）

- 独享资源：不同享（每个呼叫一旦建立起来就能够保证性能）

- 如果呼叫没有数据发送，被分配的资源就会被浪费 (no sharing)

- 通常被传统电话网络采用

### 为呼叫预留端-端资源

- 链路带宽、交换能力

- 专用资源：不共享

- 保证性能

- 要求建立呼叫连接

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 3.png)

### 网络资源（如带宽）被分成片

- 为呼叫分配片

- 如果某个呼叫没有数据，则其资源片处于空闲状态（不共享）

- 将带宽分成片

频分(Frequency-division multiplexing)
时分(Time-division multiplexing)
波分(Wave-division multiplexing)

### FDM 与 TDM

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 4.png)

## 电路交换不适合计算机之间的通信

- 连接建立时间长

- 计算机之间的通信有突发性，如果使用线路交换，则浪费的片较多（即使这个呼叫没有数据传递，其所占据的片也不能够被别的呼叫使用）

- 可靠性不高

## 1.3.2分组交换

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 5.png)

### 以分组为单位存储-转发方式

- 网络带宽资源不再分分为一个个片，传输时使用全部带宽

- 主机之间传输的数据被分为一个个分组

### 资源共享，按需使用：

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 6.png)

- 存储-转发：分组每次移动一跳（ hop ）

1. 在转发之前，节点必须收到整个分组

2. 延迟比线路交换要大

3. 排队时间

- 被传输到下一个链路之前，整个分组必须到达路由器：存储-转发

- 在一个速率为R bps的链路，一个长度为L bits 的分组的存储转发延时： L/R s

### 排队和延迟：

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 7.png)

如果到达速率>链路的输出速率:

- 分组将会排队，等待传输

- 如果路由器的缓存用完了，分组将会被抛弃

### 网络核心的关键功能

- 路由: 决定分组采用的源到目标的路径

- 转发: 将分组从路由器的输入链路转移到输出链路

### 统计多路复用

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 8.png)

A&B 时分复用 链路资源

A&B 分组没有固定的模式→统计多路复用

# 1.4接入网络和物理媒体

## 住宅接入：modem

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 9.png)

将上网数据调制加载音频信号上，在电话线上传输，在局端将其中的数据解调出来；反之亦然

- 调频

- 调幅

- 调相位

- 综合调制

### 拨号调制解调器

- 56Kbps 的速率直接接入路由器(通常更低)

- 不能同时上网和打电话：不能总是在线

### 接入网: digital subscriber line (DSL)

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 10.png)

采用现存的到交换局DSLAM的电话线

- DSL线路上的数据被传到互联网

- DSL线路上的语音被传到电话网

< 2.5 Mbps上行传输速率(typically < 1 Mbps)

< 24 Mbps下行传输速率(typically < 10 Mbps)

### 接入网: 线缆网络

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 11.png)

有线电视信号线缆双向改造

FDM: 在不同频段传输不同信道的数据，数字电视和上网数据（上下行）

 HFC: hybrid fiber coax

- 非对称: 最高30Mbps的下行传输速率, 2 Mbps 上行传输速率

线缆和光纤网络将个家庭用户接入到 ISP 路由器

各用户共享到线缆头端的接入网络

- 与DSL不同, DSL每个用户一个专用线路到CO（central office）

## 企业接入网络(Ethernet)

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 12.png)

经常被企业或者大学等机构采用

### 无线接入网络

各无线端系统共享无线接入网络（端系统到无线路由器）

通过基站或者叫接入点

# 1.5Internet结构和ISP

## 1.5.1互联网络结构：网络的网络

端系统通过接入ISPs (Internet Service Providers)连接到互联网。

接入ISPs相应的必须是互联的，因此任何2个端系统可相互发送分组到对方。

导致的“网络的网络”非常复杂，发展和演化是通过经济的和国家的政策来驱动的。

将每个接入ISP都连接到全局ISP（全局范围内覆盖）

客户ISPs和提供者ISPs有经济合约

竞争：如果全局ISP是有利可为的业务，那会有竞争者

合作：通过ISP之间的合作可以完成业务的扩展，肯定会有互联，对等互联的结算关系

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 13.png)

然后业务会细分（全球接入和区域接入），区域网络将出现，用与将接入ISPs连接到全局ISPs

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 14.png)

然 后 内 容 提 供 商 网 络(Internet Content Providers,e.g., Google,Microsoft, Akamai) 可能会构建它们自己的网络，将它们的服务、内容更加靠近端用户，向用户提供更好的服务,减少自己的运营支出

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 15.png)

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 16.png)

在网络的最中心，一些为数不多的充分连接的大范围网络（分布广、节点有限、但是之间有着多重连接）

- “tier-1” commercial ISPs (e.g., Level 3, Sprint, AT&T, NTT), 国家或者国际范围的覆盖

- content provider network (e.g., Google): 将它们的数据中心接入ISP，方便周边用户的访问；通常私有网络之间用专网绕过第一层ISP和区域ISPs

## 1.5.2Internet结构：network of networks

### 松散的层次模型

### 中心：第一层ISP（如UUNet, BBN/Genuity, Sprint,AT&T）国家/国际覆盖，速率极高

- 直接与其他第一层ISP相连

- 与大量的第二层ISP和其他客户网络相连

### 第二层ISP: 更小些的 (通常是区域性的) ISP

- 与一个或多个第一层ISPs，也可能与其他第二层ISP

### 第三层ISP与其他本地ISP

- 接入网 (与端系统最近)

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 17.png)

### 一个分组要经过许多网络

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 18.png)

## 1.5.3互联网结构：网络的网络

- 很多内容提供商(如：Google, Akamai )可能会部署自己的网络,连接自己的在各地的DC（数据中心），走自己的数据

- 连接若干local ISP和各级（包括一层）ISP,更加靠近用户

## 1.5.4ISP之间的连接

- POP: 高层ISP面向客户网络的接入点，涉及费用结算

- 对等接入：2个ISP对等互接，不涉及费用结算

- IXP：多个对等ISP互联互通之处，通常不涉及费用结算

- ICP自己部署专用网络，同时和各级ISP连接

# 1.6分组延时、丢失和吞吐量

## 1.6.1四种分组延时

### 1. 节点处理延时

- 检查 bit级差错

- 检查分组首部和决定将分组导向何处

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 19.png)

dproc = 处理延时，通常是微秒数量级或更少

dqueue = 排队延时，取决于拥塞程度

### 2. 排队延时

- 在输出链路上等待传输的时间

- 依赖于路由器的拥塞程度

- R=链路带宽 (bps)

- L=分组长度 (bits)

- a=分组到达队列的平均速率

流量强度 = La/R

- La/R ~ 0: 平均排队延时很小

- La/R -> 1: 延时变得很大

- La/R > 1: 比特到达队列的速率超过了从该队列输出的速率，平均排队延时将趋向无穷大

设计系统时流量强度不能大于1

### 3.传输延时

- R=链路带宽(bps)

- L=分组长度(bits)

- 将分组发送到链路上的时间= L/R

- 存储转发延时

### 4.传播延时

- d = 物理链路的长度

- s = 在媒体上的传播速度(~2x108 m/sec)

- 传播延时 = d/s

## 1.6.2分组丢失

- 链路的队列缓冲区容量有限

- 当分组到达一个满的队列时，该分组将会丢失

- 丢失的分组可能会被前一个节点或源端系统重传，或根本不重传

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 20.png)

## 1.6.3吞吐量

吞吐量: 在源端和目标端之间传输的速率（数据量/单位时间）

- 瞬间吞吐量: 在一个时间点的速率

- 平均吞吐量: 在一个长时间内平均值

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 21.png)

端到端平均吞吐=min{R1，R2,…,Rn}



![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 22.png)

# 1.7协议层次及服务模型

层次化方式实现复杂网络功能:

- 将网络复杂的功能分层功能明确的层次，每一层实现了其中一个或一组功能，功能中有其上层可以使用的功能：服务

- 本层协议实体相互交互执行本层的协议动作，目的是实现本层功能，通过接口为上层提供更好的服务

- 在实现本层协议的时候，直接利用了下层所提供的服务

- 本层的服务：借助下层服务实现的本层协议实体之间交互带来的新功能（上层可以利用的）+更下层所提供的服务

## 1.7.1服务和服务访问点

- 服务( Service)：低层实体向上层实体提供它们之间的通信的能力

- 原语(primitive)：上层使用下层服务的形式，高层使用低层提供的服务，以及低层向高层提供服务都是通过服务访问原语来进行交互的---形式

- 服务访问点 SAP (Services Access Point) ：上层使用下层提供的服务通过层间的接口—地点

## 1.7.2服务的类型

### 面向连接的服务( Connection-oriented Service)

- 连接(Connection)：两个通信实体为进行通信而建立的一种结合

- 面向连接的服务通信的过程：建立连接，通信，拆除连接

- 面向连接的服务的例子：网络层的连接被成为虚电路

- 适用范围：对于大的数据块要传输; 不适合小的零星报文

- 特点：保序

- 服务类型：可靠的信息流 传送页面(可靠的获得,通过接收方的确认)、可靠的字节流 远程登录、不可靠的连接 数字化声音

### 无连接的服务(Connectionless Service)

- 无连接服务：两个对等层实体在通信前不需要建立一个连接，不预留资源；不需要通信双方都是活跃；(例：寄信)

- 特点：不可靠、可能重复、可能失序

- IP分组，数据包；

- 适用范围：适合传送零星数据；

- 服务类型：不可靠的数据报 电子方式的函件、有确认的数据报 挂号信、请求回答 信息查询

## 1.7.3服务和协议

### 服务与协议的区别

- 服务(Service)：低层实体向上层实体提供它们之间的通信的能力，是通过原语(primitive)来操作的，垂直

- 协议(protocol) ：对等层实体(peer entity)之间在相互通信的过程中，需要遵循的规则的集合，水平

### 服务与协议的联系

- 本层协议的实现要靠下层提供的服务来实现

- 本层实体通过协议为上层提供更高级的服务

## 1.7.4分层处理和实现复杂系统的好处

- 概念化：结构清晰，便于标示网络组件，以及描述其相互关系

- 结构化：模块化更易于维护和系统升级

## 1.7.5Internet 协议栈

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 23.png)

### 应用层: 网络应用

- 为人类用户或者其他应用进程提供网络应用服务

- FTP, SMTP, HTTP,DNS

### 传输层: 主机之间的数据传输

- 在网络层提供的端到端通信基础上，细分为进程到进程，将不可靠的通信变成可靠地通信

- TCP, UDP

### 网络层: 为数据报从源到目的选择路由

- 主机主机之间的通信，端到端通信，不可靠

- IP, 路由协议

### 链路层: 相邻网络节点间的数据传输

- 2个相邻2点的通信，点到点通信，可靠或不可靠

- 点对对协议PPP, 802.11(wifi), Ethernet

### 物理层: 在线路上传送bit

## 1.7.6ISO/OSI 参考模型

![image.png](1.计算机网络概述+a208f7db-0cfa-45aa-b0bc-c9ab9fd8185a/image 24.png)

- 表示层: 允许应用解释传输的数据, e.g., 加密，压缩，机器相关的表示转换

- 会话层: 数据交换的同步，检查点，恢复

- 互联网协议栈没有这两层

## 1.7.7各层次的协议数据单元

- 应用层：报文(message)

- 传输层：报文段(segment)：TCP段，UDP数据报

- 网络层：分组packet（如果无连接方式：数据报datagram）

- 数据链路层：帧(frame)

- 物理层：位(bit)

